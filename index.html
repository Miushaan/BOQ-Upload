<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTCC Inspection Report Generator</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 20px; background-color: #f4f7f6; }
        .container { max-width: 950px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        /* Form Styling */
        .input-section { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #eee; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .task-row { display: grid; grid-template-columns: 1fr 1fr 2fr 50px; gap: 10px; margin-bottom: 8px; align-items: center; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9em; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        button { cursor: pointer; padding: 10px; border: none; border-radius: 4px; font-weight: bold; }
        .btn-add { background-color: #2ecc71; color: white; margin-top: 10px; }
        .btn-rmv { background-color: #e74c3c; color: white; padding: 5px; }
        .btn-print { background-color: #3498db; color: white; width: 100%; font-size: 1.1em; margin-top: 20px; }
        
        /* Report Styling */
        #report-area { display: none; margin-top: 30px; background: white; }
        .report-header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        
        /* Table Styling - Optimized for Copy-Paste */
        .report-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 14px; }
        .report-table th, .report-table td { border: 1px solid #000; padding: 8px; text-align: left; color: #000; }
        .report-table th { background-color: #f2f2f2 !important; -webkit-print-color-adjust: exact; }
        .first-row { color: red !important; font-weight: bold; } /* Highlights first task like your sample */
        
        /* Image Gallery Styling */
        .image-gallery { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px; 
            margin-top: 20px; 
        }
        .image-item img { 
            width: 100%; 
            height: 250px; /* Fixed height for uniformity */
            object-fit: cover; 
            border: none; 
            display: block;
        }

        @media print {
            .input-section, .btn-print, .btn-add, .btn-rmv, h1 { display: none !important; }
            body { background: white; padding: 0; }
            .container { box-shadow: none; max-width: 100%; width: 100%; padding: 0; }
            #report-area { display: block !important; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Inspection Report Builder</h1>

    <div class="input-section">
        <div class="grid">
            <div><label>SR No:</label><input type="text" id="in-sr" placeholder="e.g. SR-4521"></div>
            <div><label>Date:</label><input type="date" id="in-date"></div>
            <div><label>Vessel / Asset:</label><input type="text" id="in-vessel"></div>
            <div><label>Location:</label><input type="text" id="in-location" value="MTCC Shipyard"></div>
        </div>

        <h3>Tasks</h3>
        <div id="task-inputs">
            <div class="task-row">
                <input type="text" placeholder="Workshop" class="t-ws">
                <input type="text" placeholder="Location" class="t-loc">
                <input type="text" placeholder="Task Details" class="t-det">
                <span></span>
            </div>
        </div>
        <button class="btn-add" onclick="addTaskRow()">+ Add Task</button>

        <h3 style="margin-top:20px;">Summary & Photos</h3>
        <textarea id="in-summary" rows="3" placeholder="Enter summary..."></textarea>
        <input type="file" id="in-images" multiple accept="image/*" style="margin-top:10px;">

        <button class="btn-print" onclick="generateReport()">Generate & Print Report</button>
    </div>

    <div id="report-area">
        <div class="report-header">
            <h2 style="margin:0;">Maldives Transport and Contracting Company Plc</h2>
            <h3 style="margin:5px 0;">Engineering and Repair Division</h3>
            <h4 style="margin:0; text-decoration: underline;">Inspection Report</h4>
        </div>

        <table class="report-table">
            <tr>
                <td style="width:50%"><strong>SR No:</strong> <span id="out-sr" style="color:red; font-weight:bold;"></span></td>
                <td><strong>Date:</strong> <span id="out-date"></span></td>
            </tr>
            <tr>
                <td><strong>Vessel:</strong> <span id="out-vessel"></span></td>
                <td><strong>Location:</strong> <span id="out-location"></span></td>
            </tr>
        </table>

        <table class="report-table">
            <thead>
                <tr>
                    <th style="width:40px;">No.</th>
                    <th style="width:100px;">Workshop</th>
                    <th style="width:100px;">Location</th>
                    <th>Task Details</th>
                </tr>
            </thead>
            <tbody id="out-tasks"></tbody>
        </table>

        <div style="margin-top:15px;">
            <strong>Summary & Scope of Work:</strong>
            <p id="out-summary" style="margin-top:5px; line-height:1.4;"></p>
        </div>

        <div class="image-gallery" id="out-images"></div>
    </div>
</div>

<script>
    document.getElementById('in-date').valueAsDate = new Date();

    function addTaskRow() {
        const div = document.createElement('div');
        div.className = 'task-row';
        div.innerHTML = `
            <input type="text" placeholder="Workshop" class="t-ws">
            <input type="text" placeholder="Location" class="t-loc">
            <input type="text" placeholder="Task Details" class="t-det">
            <button class="btn-rmv" onclick="this.parentElement.remove()">âœ•</button>
        `;
        document.getElementById('task-inputs').appendChild(div);
    }

    async function generateReport() {
        document.getElementById('out-sr').innerText = document.getElementById('in-sr').value || "No SR";
        document.getElementById('out-date').innerText = document.getElementById('in-date').value;
        document.getElementById('out-vessel').innerText = document.getElementById('in-vessel').value || "N/A";
        document.getElementById('out-location').innerText = document.getElementById('in-location').value;
        document.getElementById('out-summary').innerText = document.getElementById('in-summary').value;

        const outTasks = document.getElementById('out-tasks');
        outTasks.innerHTML = '';
        document.querySelectorAll('.task-row').forEach((row, i) => {
            const ws = row.querySelector('.t-ws').value;
            const loc = row.querySelector('.t-loc').value;
            const det = row.querySelector('.t-det').value;
            if(ws || loc || det) {
                const tr = document.createElement('tr');
                if(i === 0) tr.className = "first-row"; // Make first row red like your image
                tr.innerHTML = `<td>${i+1}</td><td>${ws}</td><td>${loc}</td><td>${det}</td>`;
                outTasks.appendChild(tr);
            }
        });

        const imgInput = document.getElementById('in-images');
        const imgGallery = document.getElementById('out-images');
        imgGallery.innerHTML = '';

        if (imgInput.files.length > 0) {
            for (const file of Array.from(imgInput.files)) {
                const reader = new FileReader();
                await new Promise(resolve => {
                    reader.onload = (e) => {
                        const div = document.createElement('div');
                        div.className = 'image-item';
                        div.innerHTML = `<img src="${e.target.result}">`;
                        imgGallery.appendChild(div);
                        resolve();
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        document.getElementById('report-area').style.display = 'block';
        setTimeout(() => { window.print(); }, 500);
    }
</script>

</body>
</html>
